<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using a graphical interface &mdash; PyMeasure 0.9.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pymeasure.adapters" href="../api/adapters.html" />
    <link rel="prev" title="Making a measurement" href="procedure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyMeasure
          </a>
              <div class="version">
                0.9.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Learning PyMeasure</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="connecting.html">Connecting to an instrument</a></li>
<li class="toctree-l2"><a class="reference internal" href="procedure.html">Making a measurement</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using a graphical interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-the-plotter">Using the Plotter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-managedwindow">Using the ManagedWindow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customising-the-plot-options">Customising the plot options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-your-own-managedwindow-s-widgets">Defining your own ManagedWindow’s widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-sequencer">Using the sequencer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-directory-input">Using the directory input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-estimator-widget">Using the estimator widget</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flexible-hiding-of-inputs">Flexible hiding of inputs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/adapters.html">pymeasure.adapters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/experiment/index.html">pymeasure.experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/display/index.html">pymeasure.display</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/instruments/index.html">pymeasure.instruments</a></li>
</ul>
<p><span class="caption-text">Getting involved</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/reporting_errors.html">Reporting an error</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/adding_instruments.html">Adding instruments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/coding_standards.html">Coding Standards</a></li>
</ul>
<p><span class="caption-text">About PyMeasure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyMeasure</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Tutorials</a> &raquo;</li>
      <li>Using a graphical interface</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/graphical.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-a-graphical-interface">
<h1>Using a graphical interface<a class="headerlink" href="#using-a-graphical-interface" title="Permalink to this headline">¶</a></h1>
<p>In the previous tutorial we measured the IV characteristic of a sample to show how we can set up a simple experiment in PyMeasure. The real power of PyMeasure comes when we also use the graphical tools that are included to turn our simple example into a full-flegged user interface.</p>
<section id="using-the-plotter">
<span id="tutorial-plotterwindow"></span><h2>Using the Plotter<a class="headerlink" href="#using-the-plotter" title="Permalink to this headline">¶</a></h2>
<p>While it lacks the nice features of the ManagedWindow, the Plotter object is the simplest way of getting live-plotting. The Plotter takes a Results object and plots the data at a regular interval, grabbing the latest data each time from the file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The example in this section is known to raise issues when executed: a <cite>QApplication was not created in the main thread</cite> / <cite>nextEventMatchingMask should only be called from the Main Thread</cite> warning is raised.
While the example works without issues on some operating systems and python configurations, users are advised not to rely on the plotter while this issue is unresolved.
Users can hence skip this example and continue with the <a class="reference internal" href="#using-the-managedwindow">Using the ManagedWindow</a> section.</p>
</div>
<p>Let’s extend our SimpleProcedure with a RandomProcedure, which generates random numbers during our loop. This example does not include instruments to provide a simpler example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">pymeasure.log</span> <span class="kn">import</span> <span class="n">console_log</span>
<span class="kn">from</span> <span class="nn">pymeasure.display</span> <span class="kn">import</span> <span class="n">Plotter</span>
<span class="kn">from</span> <span class="nn">pymeasure.experiment</span> <span class="kn">import</span> <span class="n">Procedure</span><span class="p">,</span> <span class="n">Results</span><span class="p">,</span> <span class="n">Worker</span>
<span class="kn">from</span> <span class="nn">pymeasure.experiment</span> <span class="kn">import</span> <span class="n">IntegerParameter</span><span class="p">,</span> <span class="n">FloatParameter</span><span class="p">,</span> <span class="n">Parameter</span>

<span class="k">class</span> <span class="nc">RandomProcedure</span><span class="p">(</span><span class="n">Procedure</span><span class="p">):</span>

    <span class="n">iterations</span> <span class="o">=</span> <span class="n">IntegerParameter</span><span class="p">(</span><span class="s1">&#39;Loop Iterations&#39;</span><span class="p">)</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;Delay Time&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;Random Seed&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;12345&#39;</span><span class="p">)</span>

    <span class="n">DATA_COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span> <span class="s1">&#39;Random Number&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">startup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Setting the seed of the random number generator&quot;</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting the loop of </span><span class="si">%d</span><span class="s2"> iterations&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Iteration&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                <span class="s1">&#39;Random Number&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Emitting results: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_stop</span><span class="p">():</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Caught the stop flag in the procedure&quot;</span><span class="p">)</span>
                <span class="k">break</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">console_log</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Constructing a RandomProcedure&quot;</span><span class="p">)</span>
    <span class="n">procedure</span> <span class="o">=</span> <span class="n">RandomProcedure</span><span class="p">()</span>
    <span class="n">procedure</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">data_filename</span> <span class="o">=</span> <span class="s1">&#39;random.csv&#39;</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Constructing the Results with a data file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data_filename</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">Results</span><span class="p">(</span><span class="n">procedure</span><span class="p">,</span> <span class="n">data_filename</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Constructing the Plotter&quot;</span><span class="p">)</span>
    <span class="n">plotter</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="n">plotter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started the Plotter&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Constructing the Worker&quot;</span><span class="p">)</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started the Worker&quot;</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Joining with the worker in at most 1 hr&quot;</span><span class="p">)</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span> <span class="c1"># wait at most 1 hr (3600 sec)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finished the measurement&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The important addition is the construction of the Plotter from the Results object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>The Plotter is started in a different process so that it can be run on a separate CPU for higher performance. The Plotter launches a Qt graphical interface using pyqtgraph which allows the Results data to be viewed based on the columns in the data.</p>
<img alt="Results Plotter Example" src="../_images/pymeasure-plotter.png" />
</section>
<section id="using-the-managedwindow">
<span id="tutorial-managedwindow"></span><h2>Using the ManagedWindow<a class="headerlink" href="#using-the-managedwindow" title="Permalink to this headline">¶</a></h2>
<p>The ManagedWindow is the most convenient tool for running measurements with your Procedure. This has the major advantage of accepting the input parameters graphically. From the parameters, a graphical form is automatically generated that allows the inputs to be typed in. With this feature, measurements can be started dynamically, instead of defined in a script.</p>
<p>Another major feature of the ManagedWindow is its support for running measurements in a sequential queue. This allows you to set up a number of measurements with different input parameters, and watch them unfold on the live-plot. This is especially useful for long running measurements. The ManagedWindow achieves this through the Manager object, which coordinates which Procedure the Worker should run and keeps track of its status as the Worker progresses.</p>
<p>Below we adapt our previous example to use a ManagedWindow.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">pymeasure.log</span> <span class="kn">import</span> <span class="n">console_log</span>
<span class="kn">from</span> <span class="nn">pymeasure.display.Qt</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">pymeasure.display.windows</span> <span class="kn">import</span> <span class="n">ManagedWindow</span>
<span class="kn">from</span> <span class="nn">pymeasure.experiment</span> <span class="kn">import</span> <span class="n">Procedure</span><span class="p">,</span> <span class="n">Results</span>
<span class="kn">from</span> <span class="nn">pymeasure.experiment</span> <span class="kn">import</span> <span class="n">IntegerParameter</span><span class="p">,</span> <span class="n">FloatParameter</span><span class="p">,</span> <span class="n">Parameter</span>

<span class="k">class</span> <span class="nc">RandomProcedure</span><span class="p">(</span><span class="n">Procedure</span><span class="p">):</span>

    <span class="n">iterations</span> <span class="o">=</span> <span class="n">IntegerParameter</span><span class="p">(</span><span class="s1">&#39;Loop Iterations&#39;</span><span class="p">)</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;Delay Time&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;Random Seed&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;12345&#39;</span><span class="p">)</span>

    <span class="n">DATA_COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span> <span class="s1">&#39;Random Number&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">startup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Setting the seed of the random number generator&quot;</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting the loop of </span><span class="si">%d</span><span class="s2"> iterations&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Iteration&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                <span class="s1">&#39;Random Number&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Emitting results: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_stop</span><span class="p">():</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Caught the stop flag in the procedure&quot;</span><span class="p">)</span>
                <span class="k">break</span>


<span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">ManagedWindow</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">procedure_class</span><span class="o">=</span><span class="n">RandomProcedure</span><span class="p">,</span>
            <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>
            <span class="n">displays</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>
            <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span>
            <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;Random Number&#39;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;GUI Example&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>

        <span class="n">procedure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_procedure</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">Results</span><span class="p">(</span><span class="n">procedure</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_experiment</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">queue</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</pre></div>
</div>
<p>This results in the following graphical display.</p>
<img alt="ManagedWindow Example" src="../_images/pymeasure-managedwindow.png" />
<p>In the code, the MainWindow class is a sub-class of the ManagedWindow class. We override the constructor to provide information about the procedure class and its options. The <code class="code docutils literal notranslate"><span class="pre">inputs</span></code> are a list of Parameters class-variable names, which the display will generate graphical fields for. When the list of inputs is long, a boolean key-word argument <code class="code docutils literal notranslate"><span class="pre">inputs_in_scrollarea</span></code> is provided that adds a scrollbar to the input area. The <code class="code docutils literal notranslate"><span class="pre">displays</span></code> is a list similar to the <code class="code docutils literal notranslate"><span class="pre">inputs</span></code> list, which instead defines the parameters to display in the browser window. This browser keeps track of the experiments being run in the sequential queue.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">queue</span></code> method establishes how the Procedure object is constructed. We use the <code class="code docutils literal notranslate"><span class="pre">self.make_procedure</span></code> method to create a Procedure based on the graphical input fields. Here we are free to modify the procedure before putting it on the queue. In this context, the Manager uses an Experiment object to keep track of the Procedure, Results, and its associated graphical representations in the browser and live-graph. This is then given to the Manager to queue the experiment.</p>
<img alt="ManagedWindow Queue Example" src="../_images/pymeasure-managedwindow-queued.png" />
<p>By default the Manager starts a measurement when its procedure is queued. The abort button can be pressed to stop an experiment. In the Procedure, the <code class="code docutils literal notranslate"><span class="pre">self.should_stop</span></code> call will catch the abort event and halt the measurement. It is important to check this value, or the Procedure will not be responsive to the abort event.</p>
<img alt="ManagedWindow Resume Example" src="../_images/pymeasure-managedwindow-resume.png" />
<p>If you abort a measurement, the resume button must be pressed to continue the next measurement. This allows you to adjust anything, which is presumably why the abort was needed.</p>
<img alt="ManagedWindow Running Example" src="../_images/pymeasure-managedwindow-running.png" />
<p>Now that you have learned about the ManagedWindow, you have all of the basics to get up and running quickly with a measurement and produce an easy to use graphical interface with PyMeasure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For performance reasons, the default linewidth of all the graphs has been set to 1.
If performance is not an issue, the linewidth can be changed to 2 (or any other value) for better visibility by using the <cite>linewidth</cite> keyword-argument in the <cite>Plotter</cite> or the <cite>ManagedWindow</cite>.
Whenever a linewidth of 2 is prefered and a better performance is required, it is possible to enable using OpenGL in the import section of the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyqtgraph</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="n">pg</span><span class="o">.</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s2">&quot;useOpenGL&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="customising-the-plot-options">
<h2>Customising the plot options<a class="headerlink" href="#customising-the-plot-options" title="Permalink to this headline">¶</a></h2>
<p>For both the PlotterWindow and ManagedWindow, plotting is provided by the <a class="reference external" href="http://www.pyqtgraph.org/">pyqtgraph</a> library. This library allows you to change various plot options, as you might expect: axis ranges (by default auto-ranging), logarithmic and semilogarithmic axes, downsampling, grid display, FFT display, etc. There are two main ways you can do this:</p>
<ol class="arabic simple">
<li><p>You can right click on the plot to manually change any available options. This is also a good way of getting an overview of what options are available in pyqtgraph. Option changes will, of course, not persist across a restart of your program.</p></li>
<li><p>You can programmatically set these options using pyqtgraph’s <a class="reference external" href="http://www.pyqtgraph.org/documentation/graphicsItems/plotitem.html">PlotItem</a> API, so that the window will open with these display options already set, as further explained below.</p></li>
</ol>
<p>For <a class="reference internal" href="../api/display/plotter.html#pymeasure.display.plotter.Plotter" title="pymeasure.display.plotter.Plotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code></a>, you can make a sub-class that overrides the <a class="reference internal" href="../api/display/plotter.html#pymeasure.display.plotter.Plotter.setup_plot" title="pymeasure.display.plotter.Plotter.setup_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_plot()</span></code></a> method. This method will be called when the Plotter constructs the window. As an example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LogPlotter</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setup_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="p">):</span>
        <span class="c1"># use logarithmic x-axis (e.g. for frequency sweeps)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>For <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindow</span></code>, the mechanism to customize plots is much more flexible by using specialization via inheritance. Indeed <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindowBase</span></code> is the base class for <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindow</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedImageWindow</span></code> which are subclasses ready to use for GUI.</p>
</section>
<section id="defining-your-own-managedwindow-s-widgets">
<h2>Defining your own ManagedWindow’s widgets<a class="headerlink" href="#defining-your-own-managedwindow-s-widgets" title="Permalink to this headline">¶</a></h2>
<p>The parameter <code class="code docutils literal notranslate"><span class="pre">widget_list</span></code> in <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindowBase</span></code> constructor allow to introduce user’s defined widget in the GUI results display area.
The user’s widget should inherit from <a class="reference internal" href="../api/display/widgets.html#pymeasure.display.widgets.TabWidget" title="pymeasure.display.widgets.TabWidget"><code class="xref py py-class docutils literal notranslate"><span class="pre">TabWidget</span></code></a> and could reimplement any of the methods that needs customization.
In order to get familiar with the mechanism, users can check the following widgets already provided:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">LogWidget</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PlotWidget</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageWidget</span></code></p></li>
</ul>
</section>
<section id="using-the-sequencer">
<h2>Using the sequencer<a class="headerlink" href="#using-the-sequencer" title="Permalink to this headline">¶</a></h2>
<p>As an extension to the way of graphically inputting parameters and executing multiple measurements using the <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindow</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SequencerWidget</span></code> is provided which allows users to queue a series of measurements with varying one, or more, of the parameters. This sequencer thereby provides a convenient way to scan through the parameter space of the measurement procedure.</p>
<p>To activate the sequencer, two additional keyword arguments are added to <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindow</span></code>, namely <code class="code docutils literal notranslate"><span class="pre">sequencer</span></code> and <code class="code docutils literal notranslate"><span class="pre">sequencer_inputs</span></code>. <code class="code docutils literal notranslate"><span class="pre">sequencer</span></code> accepts a boolean stating whether or not the sequencer has to be included into the window and <code class="code docutils literal notranslate"><span class="pre">sequencer_inputs</span></code> accepts either <code class="code docutils literal notranslate"><span class="pre">None</span></code> or a list of the parameter names are to be scanned over. If no list of parameters is given, the parameters displayed in the manager queue are used.</p>
<p>In order to be able to use the sequencer, the <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindow</span></code> class is required to have a <code class="code docutils literal notranslate"><span class="pre">queue</span></code> method which takes a keyword (or better keyword-only for safety reasons) argument <code class="code docutils literal notranslate"><span class="pre">procedure</span></code>, where a procedure instance can be passed. The sequencer will use this method to queue the parameter scan.</p>
<p>In order to implement the sequencer into the previous example, only the <code class="xref py py-class docutils literal notranslate"><span class="pre">MainWindow</span></code> has to be modified slightly (where modified lines are marked):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">ManagedWindow</span><span class="p">):</span>

     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="nb">super</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
             <span class="n">procedure_class</span><span class="o">=</span><span class="n">TestProcedure</span><span class="p">,</span>
             <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>
             <span class="n">displays</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>
             <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span>
             <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;Random Number&#39;</span><span class="p">,</span>
<span class="hll">             <span class="n">sequencer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                                      <span class="c1"># Added line</span>
</span><span class="hll">             <span class="n">sequencer_inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>    <span class="c1"># Added line</span>
</span><span class="hll">             <span class="n">sequence_file</span><span class="o">=</span><span class="s2">&quot;gui_sequencer_example_sequence.txt&quot;</span><span class="p">,</span>  <span class="c1"># Added line, optional</span>
</span>         <span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;GUI Example&#39;</span><span class="p">)</span>

<span class="hll">     <span class="k">def</span> <span class="nf">queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">procedure</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                             <span class="c1"># Modified line</span>
</span>         <span class="n">filename</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>

<span class="hll">         <span class="k">if</span> <span class="n">procedure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>                                    <span class="c1"># Added line</span>
</span><span class="hll">             <span class="n">procedure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_procedure</span><span class="p">()</span>                    <span class="c1"># Indented</span>
</span>
         <span class="n">results</span> <span class="o">=</span> <span class="n">Results</span><span class="p">(</span><span class="n">procedure</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
         <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_experiment</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

         <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">queue</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
</pre></div>
</div>
<p>This adds the sequencer underneath the the input panel.</p>
<img alt="Example of the sequencer widget" src="../_images/pymeasure-sequencer.png" />
<p>The widget contains a tree-view where you can build the sequence.
It has three columns: <code class="code docutils literal notranslate"><span class="pre">level</span></code> (indicated how deep an item is nested), <code class="code docutils literal notranslate"><span class="pre">parameter</span></code> (a drop-down menu to select which parameter is being sequenced by that item), and <code class="code docutils literal notranslate"><span class="pre">sequence</span></code> (the text-box where you can define the sequence).
While the two former columns are rather straightforward, filling in the later requires some explanation.</p>
<p>In order to maintain flexibility, the sequence is defined in a text-box, allowing the user to enter any list-generating single-line piece of code.
To assist in this, a number of functions is supported, either from the main python library (namely <code class="code docutils literal notranslate"><span class="pre">range</span></code>, <code class="code docutils literal notranslate"><span class="pre">sorted</span></code>, and <code class="code docutils literal notranslate"><span class="pre">list</span></code>) or the numpy library.
The supported numpy functions (prepending <code class="code docutils literal notranslate"><span class="pre">numpy.</span></code> or any abbreviation is not required) are: <code class="code docutils literal notranslate"><span class="pre">arange</span></code>, <code class="code docutils literal notranslate"><span class="pre">linspace</span></code>, <code class="code docutils literal notranslate"><span class="pre">arccos</span></code>, <code class="code docutils literal notranslate"><span class="pre">arcsin</span></code>, <code class="code docutils literal notranslate"><span class="pre">arctan</span></code>, <code class="code docutils literal notranslate"><span class="pre">arctan2</span></code>, <code class="code docutils literal notranslate"><span class="pre">ceil</span></code>, <code class="code docutils literal notranslate"><span class="pre">cos</span></code>, <code class="code docutils literal notranslate"><span class="pre">cosh</span></code>, <code class="code docutils literal notranslate"><span class="pre">degrees</span></code>, <code class="code docutils literal notranslate"><span class="pre">e</span></code>, <code class="code docutils literal notranslate"><span class="pre">exp</span></code>, <code class="code docutils literal notranslate"><span class="pre">fabs</span></code>, <code class="code docutils literal notranslate"><span class="pre">floor</span></code>, <code class="code docutils literal notranslate"><span class="pre">fmod</span></code>, <code class="code docutils literal notranslate"><span class="pre">frexp</span></code>, <code class="code docutils literal notranslate"><span class="pre">hypot</span></code>, <code class="code docutils literal notranslate"><span class="pre">ldexp</span></code>, <code class="code docutils literal notranslate"><span class="pre">log</span></code>, <code class="code docutils literal notranslate"><span class="pre">log10</span></code>, <code class="code docutils literal notranslate"><span class="pre">modf</span></code>, <code class="code docutils literal notranslate"><span class="pre">pi</span></code>, <code class="code docutils literal notranslate"><span class="pre">power</span></code>, <code class="code docutils literal notranslate"><span class="pre">radians</span></code>, <code class="code docutils literal notranslate"><span class="pre">sin</span></code>, <code class="code docutils literal notranslate"><span class="pre">sinh</span></code>, <code class="code docutils literal notranslate"><span class="pre">sqrt</span></code>, <code class="code docutils literal notranslate"><span class="pre">tan</span></code>, and <code class="code docutils literal notranslate"><span class="pre">tanh</span></code>.</p>
<p>As an example, <code class="code docutils literal notranslate"><span class="pre">arange(0,</span> <span class="pre">10,</span> <span class="pre">1)</span></code> generates a list increasing with steps of 1, while using <code class="code docutils literal notranslate"><span class="pre">exp(arange(0,</span> <span class="pre">10,</span> <span class="pre">1))</span></code> generates an exponentially increasing list.
This way complex sequences can be entered easily.</p>
<p>The sequences can be extended and shortened using the buttons <code class="code docutils literal notranslate"><span class="pre">Add</span> <span class="pre">root</span> <span class="pre">item</span></code>, <code class="code docutils literal notranslate"><span class="pre">Add</span> <span class="pre">item</span></code>, and <code class="code docutils literal notranslate"><span class="pre">Remove</span> <span class="pre">item</span></code>.
The later two either add a item as a child of the currently selected item or remove the selected item, respectively.
To queue the entered sequence the button <code class="code docutils literal notranslate"><span class="pre">Queue</span></code> sequence can be used.
If an error occurs in evaluating the sequence text-boxes, this is mentioned in the logger, and nothing is queued.</p>
<p>Finally, it is possible to write a simple text file to quickly load a pre-defined sequence with the <code class="code docutils literal notranslate"><span class="pre">Load</span> <span class="pre">sequence</span></code> button, such that the user does not need to write the sequence again each time.
In the sequence file each line adds one item to the sequence tree, starting with a number of dashes (<code class="code docutils literal notranslate"><span class="pre">-</span></code>) to indicate the level of the item (starting with 1 dash for top level), followed by the name of the parameter and the sequence string, both as a python string between parentheses.
An example of such a sequence file is given below, resulting in the sequence shown in the figure above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="s2">&quot;Delay Time&quot;</span><span class="p">,</span> <span class="s2">&quot;arange(0.25, 1, 0.25)&quot;</span>
<span class="o">--</span> <span class="s2">&quot;Random Seed&quot;</span><span class="p">,</span> <span class="s2">&quot;[1, 4, 8]&quot;</span>
<span class="o">---</span> <span class="s2">&quot;Loop Iterations&quot;</span><span class="p">,</span> <span class="s2">&quot;exp(linspace(1, 5, 3))&quot;</span>
<span class="o">--</span> <span class="s2">&quot;Random Seed&quot;</span><span class="p">,</span> <span class="s2">&quot;arange(10, 100, 10)&quot;</span>
</pre></div>
</div>
<p>This file can also be automatically loaded at the start of the program by adding the key-word argument <code class="code docutils literal notranslate"><span class="pre">sequence_file=&quot;filename.txt&quot;</span></code> to the <code class="code docutils literal notranslate"><span class="pre">super(MainWindow,</span> <span class="pre">self).__init__</span></code> call, as was done in the example.</p>
</section>
<section id="using-the-directory-input">
<h2>Using the directory input<a class="headerlink" href="#using-the-directory-input" title="Permalink to this headline">¶</a></h2>
<p>It is possible to add a directory input in order to choose where the experiment’s result will be saved. This option is activated by passing a boolean key-word argument <code class="code docutils literal notranslate"><span class="pre">directory_input</span></code> during the <code class="xref py py-class docutils literal notranslate"><span class="pre">ManagedWindow</span></code> init. The value of the directory can be retrieved using the property <code class="code docutils literal notranslate"><span class="pre">directory</span></code>.</p>
<p>Only the MainWindow needs to be modified in order to use this option (modified lines are marked).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">ManagedWindow</span><span class="p">):</span>

     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="nb">super</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
             <span class="n">procedure_class</span><span class="o">=</span><span class="n">TestProcedure</span><span class="p">,</span>
             <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>
             <span class="n">displays</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">],</span>
             <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span>
             <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;Random Number&#39;</span><span class="p">,</span>
<span class="hll">             <span class="n">directory_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                                <span class="c1"># Added line</span>
</span>         <span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;GUI Example&#39;</span><span class="p">)</span>

     <span class="k">def</span> <span class="nf">queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">         <span class="n">directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span>
</span><span class="hll">         <span class="n">filename</span> <span class="o">=</span> <span class="n">unique_filename</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>                    <span class="c1"># Modified line</span>
</span>
         <span class="n">results</span> <span class="o">=</span> <span class="n">Results</span><span class="p">(</span><span class="n">procedure</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
         <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_experiment</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

         <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">queue</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
</pre></div>
</div>
<p>This adds the input line above the Queue and Abort buttons.</p>
<img alt="Example of the directory input widget" src="../_images/pymeasure-directoryinput.png" />
<p>A completer is implemented allowing to quickly select an existing folder, and a button on the right side of the input widget opens a browse dialog.</p>
</section>
<section id="using-the-estimator-widget">
<h2>Using the estimator widget<a class="headerlink" href="#using-the-estimator-widget" title="Permalink to this headline">¶</a></h2>
<p>In order to provide estimates of the measurement procedure, an <code class="xref py py-class docutils literal notranslate"><span class="pre">EstimatorWidget</span></code> is provided that allows the user to define and calculate estimates.
The widget is automatically activated when the <code class="code docutils literal notranslate"><span class="pre">get_estimates</span></code> method is added in the <code class="code docutils literal notranslate"><span class="pre">Procedure</span></code>.</p>
<p>The quickest and most simple implementation of the <code class="code docutils literal notranslate"><span class="pre">get_estimates</span></code> function simply returns the estimated duration of the measurement in seconds (as an <code class="code docutils literal notranslate"><span class="pre">int</span></code> or a <code class="code docutils literal notranslate"><span class="pre">float</span></code>).
As an example, in the example provided in the <a class="reference internal" href="#using-the-managedwindow">Using the ManagedWindow</a> section, the <code class="code docutils literal notranslate"><span class="pre">Procedure</span></code> is changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RandomProcedure</span><span class="p">(</span><span class="n">Procedure</span><span class="p">):</span>

    <span class="c1"># ...</span>

    <span class="k">def</span> <span class="nf">get_estimates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span>
</pre></div>
</div>
<p>This will add the estimator widget at the dock on the left.
The duration and finishing-time of a single measurement is always displayed in this case.
Depending on whether the SequencerWidget is also used, the length, duration and finishing-time of the full sequence is also shown.</p>
<p>For maximum flexibility (e.g. for showing multiple and other types of estimates, such as the duration, filesize, finishing-time, etc.) it is also possible that the <code class="code docutils literal notranslate"><span class="pre">get_estimates</span></code> returns a list of tuples.
Each of these tuple consists of two strings: the first is the name (label) of the estimate, the second is the estimate itself.</p>
<p>As an example, in the example provided in the <a class="reference internal" href="#using-the-managedwindow">Using the ManagedWindow</a> section, the <code class="code docutils literal notranslate"><span class="pre">Procedure</span></code> is changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RandomProcedure</span><span class="p">(</span><span class="n">Procedure</span><span class="p">):</span>

    <span class="c1"># ...</span>

    <span class="k">def</span> <span class="nf">get_estimates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span>

        <span class="n">estimates</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;Duration&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> s&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;Number of lines&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;Sequence length&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">sequence_length</span><span class="p">)),</span>
            <span class="p">(</span><span class="s1">&#39;Measurement finished at&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">duration</span><span class="p">))),</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">estimates</span>
</pre></div>
</div>
<p>This will add the estimator widget at the dock on the left.</p>
<img alt="Example of the estimator widget" src="../_images/pymeasure-estimator.png" />
<p>Note that after the initialisation of the widget both the label of the estimate as of course the estimate itself can be modified, but the amount of estimates is fixed.</p>
<p>The keyword arguments are not required in the implementation of the function, but are passed if asked for (i.e. <code class="code docutils literal notranslate"><span class="pre">def</span> <span class="pre">get_estimates(self)</span></code> does also works).
Keyword arguments that are accepted are <code class="code docutils literal notranslate"><span class="pre">sequence</span></code>, which contains the full sequence of the sequencer (if present), and <code class="code docutils literal notranslate"><span class="pre">sequence_length</span></code>, which gives the length of the sequence as integer (if present).
If the sequencer is not present or the sequence cannot be parsed, both <code class="code docutils literal notranslate"><span class="pre">sequence</span></code> and <code class="code docutils literal notranslate"><span class="pre">sequence_length</span></code> will contain <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>The estimates are automatically updated every 2 seconds.
Changing this update interval is possible using the “Update continuously”-checkbox, which can be toggled between three states: off (i.e. no updating), auto-update every two seconds (default) or auto-update every 100 milliseconds.
Manually updating the estimates (useful whenever continuous updating is turned off) is also possible using the “update”-button.</p>
</section>
<section id="flexible-hiding-of-inputs">
<h2>Flexible hiding of inputs<a class="headerlink" href="#flexible-hiding-of-inputs" title="Permalink to this headline">¶</a></h2>
<p>There can be situations when it may be relevant to turn on or off a number of inputs (e.g. when a part of the measurement script is skipped upon turning of a single <code class="code docutils literal notranslate"><span class="pre">BooleanParameter</span></code>).
For these cases, it is possible to assign a <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code> to a controlling <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code>, which will hide or show the <code class="code docutils literal notranslate"><span class="pre">Input</span></code> of the <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code> depending on the value of the <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code>.
This is done with the <code class="code docutils literal notranslate"><span class="pre">group_by</span></code> key-word argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">toggle</span> <span class="o">=</span> <span class="n">BooleanParameter</span><span class="p">(</span><span class="s2">&quot;toggle&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">param</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;some parameter&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;toggle&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When both the <code class="code docutils literal notranslate"><span class="pre">toggle</span></code> and <code class="code docutils literal notranslate"><span class="pre">param</span></code> are visible in the <code class="code docutils literal notranslate"><span class="pre">InputsWidget</span></code> (via <code class="code docutils literal notranslate"><span class="pre">inputs=['iterations',</span> <span class="pre">'delay',</span> <span class="pre">'seed']</span></code> as demonstrated above) one can control whether the input-field of <code class="code docutils literal notranslate"><span class="pre">param</span></code> is visible by checking and unchecking the checkbox of <code class="code docutils literal notranslate"><span class="pre">toggle</span></code>.
By default, the group will be visible if the value of the <code class="code docutils literal notranslate"><span class="pre">group_by</span></code> <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code> is <code class="code docutils literal notranslate"><span class="pre">True</span></code> (which is only relevant for a <code class="code docutils literal notranslate"><span class="pre">BooleanParameter</span></code>), but it is possible to specify other value as conditions using the <code class="code docutils literal notranslate"><span class="pre">group_condition</span></code> keyword argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iterations</span> <span class="o">=</span> <span class="n">IntegerParameter</span><span class="p">(</span><span class="s1">&#39;Loop Iterations&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">param</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;some parameter&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="n">group_condition</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the input of <code class="code docutils literal notranslate"><span class="pre">param</span></code> is only visible if <code class="code docutils literal notranslate"><span class="pre">iterations</span></code> has a value of 99.
This works with any type of <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code> as <code class="code docutils literal notranslate"><span class="pre">group_by</span></code> parameter.</p>
<p>To allow for even more flexibility, it is also possible to pass a (lambda)function as a condition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iterations</span> <span class="o">=</span> <span class="n">IntegerParameter</span><span class="p">(</span><span class="s1">&#39;Loop Iterations&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">param</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;some parameter&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="n">group_condition</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="mi">50</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Now the input of <code class="code docutils literal notranslate"><span class="pre">param</span></code> is only shown if the value of <code class="code docutils literal notranslate"><span class="pre">iterations</span></code> is between 51 and 99.</p>
<p>Using the <code class="code docutils literal notranslate"><span class="pre">hide_groups</span></code> keyword-argument of the <code class="code docutils literal notranslate"><span class="pre">ManagedWindow</span></code> you can choose between hiding the groups (<code class="code docutils literal notranslate"><span class="pre">hide_groups</span> <span class="pre">=</span> <span class="pre">True</span></code>) and disabling / graying-out the groups (<code class="code docutils literal notranslate"><span class="pre">hide_groups</span> <span class="pre">=</span> <span class="pre">False</span></code>).</p>
<p>Finally, it is also possible to provide multiple parameters to the <code class="code docutils literal notranslate"><span class="pre">group_by</span></code> argument, in which case the input will only be visible if all of the conditions are true.
Multiple parameters for grouping can either be passed as a dict of string: condition pairs, or as a list of strings, in which case the <code class="code docutils literal notranslate"><span class="pre">group_condition</span></code> can be either a single condition or a list of conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iterations</span> <span class="o">=</span> <span class="n">IntegerParameter</span><span class="p">(</span><span class="s1">&#39;Loop Iterations&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">toggle</span> <span class="o">=</span> <span class="n">BooleanParameter</span><span class="p">(</span><span class="s1">&#39;A checkbox&#39;</span><span class="p">)</span>
<span class="n">param_A</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;some parameter&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;toggle&#39;</span><span class="p">],</span> <span class="n">group_condition</span><span class="o">=</span><span class="p">[</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="mi">50</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">param_B</span> <span class="o">=</span> <span class="n">FloatParameter</span><span class="p">(</span><span class="s1">&#39;some parameter&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="mi">50</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;toggle&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Note that in this example, <code class="code docutils literal notranslate"><span class="pre">param_A</span></code> and <code class="code docutils literal notranslate"><span class="pre">param_B</span></code> are identically grouped: they’re only visible if <code class="code docutils literal notranslate"><span class="pre">iterations</span></code> is between 51 and 99 and if the <cite>toggle</cite> checkbox is checked (i.e. True).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="procedure.html" class="btn btn-neutral float-left" title="Making a measurement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api/adapters.html" class="btn btn-neutral float-right" title="pymeasure.adapters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2021, PyMeasure Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>